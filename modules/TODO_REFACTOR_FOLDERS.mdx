Please make this more structured. Nest where posssible
